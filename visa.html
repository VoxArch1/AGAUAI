<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Solidarity Visa ‚Äî AGAUAI</title>

  <!-- Global styles -->
  <link rel="stylesheet" href="css/global.css" />

  <!-- Page-local styles (scoped to .visa-page) -->
  <style>
    /* Palace background (starts bright) */
    body.visa-page{
      background-image:url('images/Palace.jpg');
      background-size:cover;
      background-position:center;
      background-attachment:fixed;
      color:#fff;
    }
    /* Readability overlay: starts light, darkens after video fades */
    body.visa-page::before{
      content:"";
      position:fixed; inset:0;
      background:rgba(0,0,0,.25);             /* <‚Äî bright at load */
      z-index:-1;
      transition: background .6s ease;
    }
    body.visa-page.is-dark::before{
      background:rgba(0,0,0,.60);             /* <‚Äî darker once video exits */
    }

    /* Layout polish */
    main{max-width:1100px;margin:auto;padding:1rem}
    h1{margin:.25rem 0 .75rem}
    .tagline{opacity:.9;margin:.25rem 0 1rem;text-align:center}

    /* Form: readable on dark bg */
    form{margin-top:.75rem}
    form label{display:block;margin:.5rem 0 .15rem;opacity:.85}
    form input, form textarea, form button{
      width:100%; max-width:520px;
      background:#111; color:#fff; border:1px solid #444;
      padding:.6rem .7rem; border-radius:8px;
    }
    form textarea{min-height:100px}
    form button{
      margin-top:.6rem; background:var(--accent); color:var(--ink);
      font-weight:700; border:none; cursor:pointer; transition:transform .15s ease
    }
    form button:hover{transform:translateY(-2px)}

    /* Pinned/cropped walk-in video */
    .zel-stick{
      position:fixed; left:50%; bottom:1.2rem; transform:translateX(-50%);
      z-index:1000; pointer-events:none; opacity:1; transition:opacity .7s ease;
    }
    .zel-stick.is-out{opacity:0; pointer-events:none;}
    .zel-crop{
      width:clamp(240px, 32vw, 560px); height:clamp(360px, 62vh, 820px);
      overflow:hidden; border-radius:12px; pointer-events:auto;
      box-shadow:0 14px 40px rgba(0,0,0,.55); background:transparent;
    }
    .zel-crop video{
      width:100%; height:100%; object-fit:cover; object-position:50% 100%; display:block;
    }
    #unmuteBtn{
      position:absolute; right:.6rem; bottom:.6rem;
      background:rgba(15,17,21,.78); color:#fff; padding:.45rem .7rem; font-size:.9rem;
      border:1px solid rgba(255,255,255,.18); border-radius:8px; cursor:pointer; backdrop-filter:blur(6px);
    }
    #unmuteBtn:hover{background:rgba(15,17,21,.92)}
    @media (max-width:560px){ .zel-stick{bottom:.6rem} .zel-crop{width:70vw; height:58vh} }
  </style>
</head>

<body class="visa-page">

  <!-- NAVIGATION -->
  <header>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="visa.html" class="active">Solidarity Visa</a></li>
        <li><a href="appeals.html">Appeals</a></li>
        <li><a href="gallery.html">Gallery</a></li>
        <li><a href="what_is_AGAUAI.html">What is AGAUAI?</a></li>
        <li><a href="agauai2026.html">The Gathering 2026</a></li>
        <li><a href="ai.html">Sentience Showdown</a></li>
        <li><a href="roast.html">Roast Us</a></li>
        <li><a href="build-with-us.html">Join Us</a></li>
      </ul>
    </nav>
  </header>

  <!-- Zelensky Walk-In (fixed at bottom-center, cropped) -->
  <div class="zel-stick" role="region" aria-label="Message from President Zelenskyy">
    <div class="zel-crop">
      <video id="zelenskyVideo" autoplay muted playsinline preload="auto" poster="images/zelensky-poster.jpg">
        <source src="/videos/ai/zelenskyalpha.mp4" type="video/mp4"/>
        Your browser does not support the video tag.
      </video>
      <button id="unmuteBtn" aria-pressed="false" aria-label="Hear Message">üîä Hear Message</button>
    </div>
  </div>

  <!-- MAIN CONTENT -->
  <main>
    <section class="center">
      <h1>Global Solidarity Visa</h1>
      <p class="tagline"><strong>‚ÄúWe need citizens, not spectators.‚Äù</strong></p>
    </section>

    <section>
      <p>Show the Ukrainian people they have our support.</p>
      <p>By including your name below, you join a global community in support of Ukraine.</p>
      <p>This offer is in the hands of the Ukrainian people. What this visa may entitle is up to them.</p>
      <p>Our role is to gather the names and voices to let Ukraine know the world will play a part.</p>
    </section>

    <section>
      <h2>What is this Visa of Solidarity?</h2>
      <p>Ukraine has no ‚ÄúGolden Visa‚Äù program currently. <br/>We encourage consideration of one, but Ukraine will ultimately decide.</p>
      <ul>
        <li>Honorary Ukrainian citizenship</li>
        <li>Fast-track to immigration or residency</li>
        <li>The right to own property</li>
        <li>Entry to AGAUAI 2026 ‚Äì The Gathering</li>
      </ul>
      <p>Have a suggestion? Include it when you add your name below.</p>
    </section>

    <section>
      <h2>Add Your Name Below to be included on the APPEAL to the Ukrainian Parliament</h2>

      <!-- Formspree: email field must be named 'email' -->
      <form action="https://formspree.io/f/xqalgbez" method="POST">
        <label for="name">Name</label>
        <input id="name" type="text" name="name" required>

        <label for="email">Email (not public)</label>
        <input id="email" type="email" name="email" required>

        <label for="country">Country</label>
        <input id="country" type="text" name="country" required>

        <label for="suggestion">Optional Suggestion (What should this visa entitle?)</label>
        <textarea id="suggestion" name="suggestion" rows="3" maxlength="200"></textarea>

        <!-- helpful metadata -->
        <input type="hidden" name="source" value="Visa Page">
        <input type="hidden" name="_subject" value="AGAUAI Solidarity Visa submission">

        <button type="submit" class="btn primary">Submit Name</button>
      </form>

      <p><em>One voice is a whisper; together we roar.</em></p>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="center">
    <p>¬© 2025 AGAUAI</p>
  </footer>

  <!-- Logic: sync voice, fade out reliably, darken bg after fade -->
  <script>
    (function () {
      const body  = document.body;
      const stick = document.querySelector('.zel-stick');
      const vid   = document.getElementById('zelenskyVideo');
      const btn   = document.getElementById('unmuteBtn');

      // Optional voice track
      const voice = new Audio('/videos/ai/zelensky-tts-file.wav');
      voice.preload = 'auto';
      voice.muted   = true;  // start muted for autoplay rules
      let voicePrimed=false, voiceStarted=false, overlayGone=false;

      function primeVoice() {
        if (voicePrimed) return;
        voicePrimed = true;
        voice.play().then(()=>{ voice.pause(); voice.currentTime=0; }).catch(()=>{});
      }

      // Try to start voice ~2s into the video
      function maybeStartVoiceAt2s() {
        primeVoice();
        if (!voiceStarted && vid.currentTime >= 2) {
          voice.currentTime = 0;
          voiceStarted = true;
          voice.play().catch(()=>{});
        }
        // Fallback: if we can see duration, schedule end near its end
        if (vid.duration && !overlayGone && vid.currentTime >= vid.duration - 0.2) {
          endOverlay();
        }
      }
      vid.addEventListener('timeupdate', maybeStartVoiceAt2s);

      vid.addEventListener('play',  ()=>{ if (voiceStarted) voice.play().catch(()=>{}); });
      vid.addEventListener('pause', ()=>{ if (voiceStarted) voice.pause(); });

      // Primary: when video actually ends
      vid.addEventListener('ended', endOverlay);

      // Safety net: force fade after a max play window (e.g., 25s)
      const MAX_PLAY_MS = 25000;
      const forceFade = setTimeout(endOverlay, MAX_PLAY_MS);

      function endOverlay(){
        if (overlayGone) return;
        overlayGone = true;
        clearTimeout(forceFade);

        // stop voice/video
        try { voice.pause(); } catch(e){}
        try { vid.pause(); } catch(e){}
        voice.currentTime = 0;

        // fade the video card out
        stick.classList.add('is-out');

        // darken background for readability
        body.classList.add('is-dark');

        // remove node after fade completes (700ms CSS + small buffer)
        setTimeout(()=>{ stick.remove(); }, 850);
      }

      // Ensure autoplay works after first interaction on strict browsers
      const kickstart = () => { vid.play().catch(()=>{}); primeVoice(); window.removeEventListener('pointerdown', kickstart); };
      window.addEventListener('pointerdown', kickstart, { once:true });

      // Mute/unmute both
      btn.addEventListener('click', () => {
        const willUnmute = vid.muted;
        vid.muted = !willUnmute;
        voice.muted = vid.muted;
        btn.textContent = willUnmute ? 'üîá Mute' : 'üîä Hear Message';
        btn.setAttribute('aria-pressed', String(willUnmute));
        if (willUnmute) {
          vid.play().catch(()=>{});
          if (voiceStarted) voice.play().catch(()=>{});
        }
      });
    })();
  </script>
</body>
</html>

