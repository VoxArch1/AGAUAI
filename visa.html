<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Solidarity Visa ‚Äî AGAUAI</title>

  <!-- Your site-wide styles; keep this -->
  <link rel="stylesheet" href="css/style.css" />

  <!-- Page-local styles just for the pinned video overlay -->
  <style>
    /* Dark overlay on the palace background for readability */
    body.visa-page::before{
      content:"";
      position:fixed; inset:0;
      background: rgba(0,0,0,.60);
      z-index:-1;
    }

    /* Pinned/cropped walk-in video ----------------------------- */
    .zel-stick{
      position:fixed;
      left:50%;
      bottom:1.2rem;
      transform:translateX(-50%);
      z-index:1000;
      pointer-events:none;        /* let page be clickable underneath */
      opacity:1;
      transition:opacity .7s ease;
    }
    .zel-stick.is-out{
      opacity:0;
      pointer-events:none;
    }

    .zel-crop{
      width: clamp(240px, 32vw, 560px);
      height: clamp(360px, 62vh, 820px);
      overflow:hidden;
      border-radius:12px;
      background:transparent;
      pointer-events:auto;        /* re-enable inside */
      box-shadow: 0 14px 40px rgba(0,0,0,.55);
    }

    .zel-crop video{
      width:100%;
      height:100%;
      object-fit:cover;           /* zoom & crop side bars */
      object-position:50% 100%;   /* keep feet near bottom */
      display:block;
      background:transparent;
    }

    #unmuteBtn{
      position:absolute;
      right:.6rem;
      bottom:.6rem;
      background:rgba(15,17,21,.78);
      color:#fff;
      padding:.45rem .7rem;
      font-size:.9rem;
      border:1px solid rgba(255,255,255,.18);
      border-radius:8px;
      cursor:pointer;
      backdrop-filter: blur(6px);
    }
    #unmuteBtn:hover{ background:rgba(15,17,21,.92); }

    @media (max-width:560px){
      .zel-stick{ bottom:.6rem; }
      .zel-crop{ width:70vw; height:58vh; }
    }
  </style>
</head>

<body class="visa-page">

  <!-- NAVIGATION -->
  <header>
    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="visa.html" class="active">Solidarity Visa</a></li>
        <li><a href="appeals.html">Appeals</a></li>
        <li><a href="gallery.html">Gallery</a></li>
        <li><a href="sponsors.html">What is AGAUAI?</a></li>
        <li><a href="agauai2026.html">The Gathering 2026</a></li>
        <li><a href="ai.html">Sentience Showdown</a></li>
        <li><a href="roast.html">Roast Us</a></li>
        <li><a href="build-with-us.html">Join Us</a></li>
      </ul>
    </nav>
  </header>

  <!-- Zelensky Walk-In (fixed at bottom-center, cropped) -->
  <div class="zel-stick" role="region" aria-label="Message from President Zelenskyy">
    <div class="zel-crop">
      <video id="zelenskyVideo" autoplay muted playsinline preload="auto" poster="images/zelensky-poster.jpg">
        <source src="/videos/ai/zelenskyalpha.mp4" type="video/mp4"/>
        Your browser does not support the video tag.
      </video>
      <button id="unmuteBtn" aria-pressed="false" aria-label="Hear Message">üîä Hear Message</button>
    </div>
  </div>

  <!-- MAIN CONTENT -->
  <main>
    <section>
      <h1>Global Solidarity Visa</h1>
      <p class="tagline"><strong>‚ÄúWe need citizens, not spectators.‚Äù</strong></p>

      <p>Show the Ukrainian people they have our support.</p>
      <p>By including your name below, you join a global community in support of Ukraine.</p>
      <p>This offer is in the hands of the Ukrainian people. What this visa may entitle is up to them.</p>
      <p>Our role is to gather the names and voices to let Ukraine know the world will play a part.</p>
    </section>

    <section>
      <h2>What is this Visa of Solidarity?</h2>
      <p>Ukraine has no ‚ÄúGolden Visa‚Äù program currently. <br/>We encourage consideration of one, but Ukraine will ultimately decide.</p>
      <ul>
        <li>Honorary Ukrainian citizenship</li>
        <li>Fast-track to immigration or residency</li>
        <li>The right to own property</li>
        <li>Entry to AGAUAI 2026 ‚Äì The Gathering</li>
      </ul>
      <p>Have a suggestion? Include it when you add your name below.</p>
    </section>

    <section>
      <h2>Add Your Name Below to be included on the APPEAL to the Ukrainian Parliament</h2>

      <form action="https://formspree.io/f/xqalgbez" method="POST">
        <label for="name">Name:</label><br />
        <input id="name" type="text" name="name" required><br /><br />

        <label for="email">Email (not public):</label><br />
        <input id="email" type="email" name="_replyto" required><br /><br />

        <label for="country">Country:</label><br />
        <input id="country" type="text" name="country" required><br /><br />

        <label for="suggestion">Optional Suggestion (What should this visa entitle?):</label><br />
        <textarea id="suggestion" name="suggestion" rows="3" maxlength="200"></textarea><br /><br />
        <input type="hidden" name="source" value="Visa Page"/>

        <button type="submit">Submit Name</button>
      </form>

      <p><em>One voice is a whisper; together we roar.</em></p>
    </section>
  </main>

  <!-- FOOTER -->
  <footer>
    <p>¬© 2025 AGAUAI</p>
  </footer>

  <!-- Logic: sync voice, start it at t=3s, mute/unmute both, fade out on end -->
  <script>
    (function () {
      const stick = document.querySelector('.zel-stick');
      const vid   = document.getElementById('zelenskyVideo');
      const btn   = document.getElementById('unmuteBtn');

      // Voice track (in your repo): /videos/ai/zelensky-tts-file.wav
      const voice = new Audio('/videos/ai/zelensky-tts-file.wav');
      voice.preload = 'auto';
      voice.muted   = true;        // start muted to satisfy autoplay policies
      let voicePrimed  = false;
      let voiceStarted = false;

      function primeVoice() {
        if (voicePrimed) return;
        voicePrimed = true;
        // A tiny play/pause while muted helps future play() succeed everywhere
        voice.play().then(() => {
          voice.pause();
          voice.currentTime = 0;
        }).catch(() => {});
      }

      // Try to start the voice exactly when the video time passes 3.0s
      function maybeStartVoiceAt3s() {
        primeVoice();
        if (!voiceStarted && vid.currentTime >= 2) {
          voice.currentTime = 0;
          voiceStarted = true;
          voice.play().catch(()=>{});
        }
      }
      vid.addEventListener('timeupdate', maybeStartVoiceAt3s);

      // Keep voice in lockstep with the video
      vid.addEventListener('play',  () => { if (voiceStarted) voice.play().catch(()=>{}); });
      vid.addEventListener('pause', () => { if (voiceStarted) voice.pause(); });

      // Fade the overlay away when the walk-in finishes
      vid.addEventListener('ended', () => {
        if (voiceStarted) { voice.pause(); voice.currentTime = 0; }
        setTimeout(() => {
          stick.classList.add('is-out');
          setTimeout(() => stick.remove(), 800);  // matches .7s CSS transition + buffer
        }, 150);
      });

      // Kickstart on first interaction for stricter browsers
      const kickstart = () => {
        vid.play().catch(()=>{});
        primeVoice();
        window.removeEventListener('pointerdown', kickstart);
      };
      window.addEventListener('pointerdown', kickstart, { once:true });

      // Mute/unmute toggles both video and voice
      btn.addEventListener('click', () => {
        const willUnmute = vid.muted;    // current state before toggling
        vid.muted   = !willUnmute;
        voice.muted = vid.muted;

        btn.textContent = willUnmute ? 'üîá Mute' : 'üîä Hear Message';
        btn.setAttribute('aria-pressed', String(willUnmute));

        // ensure playback if the user just unmuted
        if (willUnmute) {
          vid.play().catch(()=>{});
          if (voiceStarted) voice.play().catch(()=>{});
        }
      });
    })();
  </script>
</body>
</html>
