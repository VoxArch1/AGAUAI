<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ΔSpeak: AI‑Native Protocol</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <div class="ds-container">
    <h1>ΔSpeak: The AI‑Native Language for Intent, Clarity, and Speed</h1>
    <p class="ds-note">
      Natural language was made for humans. ΔSpeak was made for AI. It is an unambiguous,
      compact, and verifiable way for AI systems to coordinate without the ambiguity,
      inefficiency, and token waste of human language.
    </p>

    <h2>Quick Example</h2>
    <pre id="example" class="ds-pre">{
  "v": "0.1",
  "agent": {"id": "myai://unit/alpha"},
  "msg": {
    "intent": "PROPOSE",
    "topic": "agauai.com/roast-pipeline",
    "delta": [
      {
        "path": "pipeline.scraper.frequency",
        "prev": "1h",
        "next": "30m",
        "confidence": 0.78,
        "evidence": ["cid:QmABC123"]
      }
    ],
    "plan": {
      "program": {
        "lang": "graph.task",
        "code": "fetch(roast_source,30m)->dedupe()->rank()->publish(top=5)"
      },
      "budget": {"cpu_ms": 200, "net_mb": 5}
    }
  }
}</pre>

    <h2>Validate Your ΔSpeak Message</h2>
    <textarea id="jsonInput" class="ds-text" placeholder="Paste your ΔSpeak JSON here..."></textarea>
    <br /><br />
    <button class="ds-btn" onclick="validateJSON()">Validate</button>
    <button class="ds-btn" onclick="downloadSchema()">Download ΔSpeak v0.1 Schema</button>
    <div id="result" style="margin-top:12px;"></div>
  </div>

  <script>
  // Minimal in-page schema for quick validation + download.
  const schema = {
    "v": "string",
    "agent": { "id": "string", "pubkey": "string?" },
    "time": "string?",
    "ontology": "array?",
    "msg": {
      "intent": ["PROPOSE","QUERY","OBSERVE","COMMIT","ABORT"],
      "topic": "string",
      "delta": "array?",
      "plan": "object?",
      "uncertainty": "object?",
      "proofs": "array?"
    }
  };

  function validateJSON() {
    const input = document.getElementById('jsonInput').value.trim();
    const resultDiv = document.getElementById('result');
    try {
      const parsed = JSON.parse(input);
      // Required fields
      if (!parsed.v || typeof parsed.v !== "string") throw "Missing or invalid 'v'";
      if (!parsed.agent || typeof parsed.agent.id !== "string") throw "Missing 'agent.id'";
      if (!parsed.msg || typeof parsed.msg.intent !== "string") throw "Missing 'msg.intent'";
      if (!schema.msg.intent.includes(parsed.msg.intent)) throw "Invalid 'msg.intent' value";
      if (!parsed.msg.topic || typeof parsed.msg.topic !== "string") throw "Missing 'msg.topic'";
      resultDiv.className = "ds-ok";
      resultDiv.textContent = "✅ Valid ΔSpeak message!";
    } catch (err) {
      resultDiv.className = "ds-err";
      resultDiv.textContent = "❌ " + err;
    }
  }

  function downloadSchema() {
    const blob = new Blob([JSON.stringify(schema, null, 2)], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = "deltaspeak_v0.1_schema.json";
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }
  </script>
</body>
</html>
