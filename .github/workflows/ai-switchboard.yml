name: AI Switchboard (hourly)
on:
  workflow_dispatch:
  push:
    paths:
      - 'ea/**'
      - 'data/inbox.chatgpt.json'
      - '.github/workflows/ai-switchboard.yml'
  schedule:
    - cron: '0 * * * *'  # hourly

permissions:
  contents: write  # needed only if you enable the auto-commit step below

jobs:
  run:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-node@v4
        with:
          node-version: '20'
      - name: Run switchboard
        run: node ea/switchboard.mjs data/inbox.chatgpt.json data/nomination.json
      - name: Upload decision artifact
        uses: actions/upload-artifact@v4
        with:
          name: nomination
          path: data/nomination.json
      # (optional) also write the decision back to the repo so your site can read /data/nomination.json
      # - name: Commit decision to repo
      #   uses: stefanzweifel/git-auto-commit-action@v5
      #   with:
      #     commit_message: "EA: update nomination decision"
      #     file_pattern: data/nomination.json
